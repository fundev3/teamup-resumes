trigger:
  branches:
    include:
      - main
      - develop

pr:
  branches:
    include:
      - main
      - develop
  drafts: false

variables:
  projects: "**/*.sln"
  azureSubscription: a797242d-ce60-41aa-98ca-2e22d5221cfe
  appName: team-up-backend
  vmImageName: 'ubuntu-latest' # is optional but I'm gonna create

pool:
  vmImage: ubuntu-latest

steps:
  - task: UseDotNet@2
    displayName: "Install DotNet"
    inputs:
      packageType: "sdk"
      version: "3.x"

  - task: DotNetCoreCLI@2
    displayName: "DotNet Build"
    inputs:
      command: "build"
      projects: $(projects)
      arguments: "--output $(Build.ArtifactStagingDirectory)"

  - task: PublishBuildArtifacts@1
    displayName: "DotNet Drop"
    condition: and(succeeded(), ne(variables['Build.Reason'], 'PullRequest'))
    inputs:
      PathtoPublish: "$(Build.ArtifactStagingDirectory)"
      ArtifactName: "Drop"
      publishLocation: "Container"

  - task: AzureFunctionApp@1 # Add this at the end of your file
    inputs:
      azureSubscription: azureSubscription
      appType: functionAppLinux
      appName: $(appName)
      package: $(System.ArtifactsDirectory)/**/*.zip
      appSettings: 
